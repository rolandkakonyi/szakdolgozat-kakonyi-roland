<!DOCTYPE html>
<html><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
        <title>
            jeroenvandijk's
          gist: 346165 — Gist
        </title>

    <meta content="authenticity_token" name="csrf-param">
<meta content="ma0MVrgNcUicFArHoNsQyv7LRGHDev9DUGLC00R/JLk=" name="csrf-token">

    <link href="heatmap_algorythm_elemei/gist-8014d901b91a9e1f2ed61d07883151a15e6d45a7.css" media="screen" rel="stylesheet" type="text/css">

    <script src="heatmap_algorythm_elemei/jquery-f9e740d10a70e9aeef9e8c1511ea3b7dbcb3e417.js" type="text/javascript"></script>
    <script src="heatmap_algorythm_elemei/gist-406c277ca4c43d7602cb89b5f43d35144b2577ea.js" type="text/javascript"></script><script src="heatmap_algorythm_elemei/ga.js" async="" type="text/javascript"></script>
    

    
  
  <link href="https://github.com/api/oembed?format=json&amp;url=https%3A%2F%2Fgist.github.com%2F346165" rel="alternate" title="gist: 346165" type="application/json+oembed">
  

  </head>

  <body class="windows">
    <div id="main">
      <div id="header" class="">
        <div class="site">
          <div class="logo">
            <a href="https://gist.github.com/"><img alt="gist" src="heatmap_algorythm_elemei/logo_gist.png" width="164" height="45"></a>
          </div>

            <ul class="userbox logged_out">
              <ul class="usernav">
                <li><a href="https://gist.github.com/login?return_to=/346165" rel="nofollow">Login</a></li>
                <li><a href="https://github.com/signup?return_to=gist">Signup for a GitHub Account</a></li>
              </ul>
            </ul>

          <div class="topsearch">
<form action="/gists/search" id="top_search_form" method="get">              <input name="q" results="5" class="search placeholder" placeholder="Search Gists…" type="search"> <input value="Search" class="button" type="submit">
              <input name="page" value="1" type="hidden">
</form>
            <ul class="nav">
              <li><a href="https://gist.github.com/">New Gist</a></li>
              <li><a href="https://gist.github.com/gists">All Gists</a></li>
              <li><a href="https://github.com/">Back to GitHub</a></li>
            </ul>
          </div><!-- /.topsearch -->
        </div>
      </div>

    <div class="site">
      
<div class="secondary">

  <div id="owner">
      <div class="actor">
        <div class="gravatar">
          <img src="heatmap_algorythm_elemei/3e626f6013805e96a95e999fc691b21f.jpg" width="30" height="30">
        </div>
        <div class="name"><a href="https://gist.github.com/jeroenvandijk">jeroenvandijk</a> <span>(owner)</span></div>
      </div>
  </div>


    <div class="fork-info" id="forks">
      <h3>Forks</h3>
      <ul class="gists forks">
        <li>
          <a href="https://gist.github.com/1080232">gist: 1080232</a>
          by <a href="https://gist.github.com/Blahah">Blahah</a>
          <span class="description"></span>
          <small>created <span class="date"><time class="js-relative-date" datetime="2011-07-13T05:46:18-07:00" title="2011-07-13 05:46:18">July 13, 2011</time></span></small>
        </li>
      </ul>
    </div>

  <div id="revisions">
    <h3>Revisions</h3>
    <ul>
        <li class="current">
          <img alt="" src="heatmap_algorythm_elemei/dot_green.png"><img alt="" src="heatmap_algorythm_elemei/dot_red.png"><img alt="" src="heatmap_algorythm_elemei/dot_red.png"><img alt="" src="heatmap_algorythm_elemei/dot_red.png"><img alt="" src="heatmap_algorythm_elemei/dot_red.png"><img alt="" src="heatmap_algorythm_elemei/dot_gray.png"><img alt="" src="heatmap_algorythm_elemei/dot_gray.png">
          <a href="https://gist.github.com/346165/b336fe20001a9a906ded4c65a77bb2ad739d4821" class="id">b336fe</a>

            <a href="https://gist.github.com/jeroenvandijk" class="author">jeroenv...</a>
          <span class="date"><time class="js-relative-date" datetime="2010-03-27T10:00:46-07:00" title="2010-03-27 10:00:46">March 27, 2010</time></span>
        </li>
        <li class="other">
          <img alt="" src="heatmap_algorythm_elemei/dot_green.png"><img alt="" src="heatmap_algorythm_elemei/dot_green.png"><img alt="" src="heatmap_algorythm_elemei/dot_green.png"><img alt="" src="heatmap_algorythm_elemei/dot_red.png"><img alt="" src="heatmap_algorythm_elemei/dot_red.png"><img alt="" src="heatmap_algorythm_elemei/dot_gray.png"><img alt="" src="heatmap_algorythm_elemei/dot_gray.png">
          <a href="https://gist.github.com/346165/95ca7ccad9201c5951bbe4bcacb314e43ac95ea4" class="id">95ca7c</a>

            <a href="https://gist.github.com/jeroenvandijk" class="author">jeroenv...</a>
          <span class="date"><time class="js-relative-date" datetime="2010-03-27T09:59:29-07:00" title="2010-03-27 09:59:29">March 27, 2010</time></span>
        </li>
        <li class="other">
          <img alt="" src="heatmap_algorythm_elemei/dot_green.png"><img alt="" src="heatmap_algorythm_elemei/dot_green.png"><img alt="" src="heatmap_algorythm_elemei/dot_green.png"><img alt="" src="heatmap_algorythm_elemei/dot_red.png"><img alt="" src="heatmap_algorythm_elemei/dot_red.png"><img alt="" src="heatmap_algorythm_elemei/dot_red.png"><img alt="" src="heatmap_algorythm_elemei/dot_gray.png">
          <a href="https://gist.github.com/346165/b3f115c5cc94c5e7e441a67acf75d751e59d7546" class="id">b3f115</a>

            <a href="https://gist.github.com/jeroenvandijk" class="author">jeroenv...</a>
          <span class="date"><time class="js-relative-date" datetime="2010-03-27T08:49:02-07:00" title="2010-03-27 08:49:02">March 27, 2010</time></span>
        </li>
        <li class="other">
          <img alt="" src="heatmap_algorythm_elemei/dot_green.png"><img alt="" src="heatmap_algorythm_elemei/dot_green.png"><img alt="" src="heatmap_algorythm_elemei/dot_green.png"><img alt="" src="heatmap_algorythm_elemei/dot_green.png"><img alt="" src="heatmap_algorythm_elemei/dot_green.png"><img alt="" src="heatmap_algorythm_elemei/dot_green.png"><img alt="" src="heatmap_algorythm_elemei/dot_gray.png">
          <a href="https://gist.github.com/346165/fb2c280033d5c735b31ee2a5b108a231e39d287b" class="id">fb2c28</a>

            <a href="https://gist.github.com/jeroenvandijk" class="author">jeroenv...</a>
          <span class="date"><time class="js-relative-date" datetime="2010-03-27T08:44:26-07:00" title="2010-03-27 08:44:26">March 27, 2010</time></span>
        </li>
    </ul>
  </div>
</div><!-- /.secondary -->

<div class="main">
  <div id="repos" class="readability-header">
    <div class="repo public">
      <div class="title">
        <div class="path">
          gist: 346165


            <a href="https://gist.github.com/gists/346165/download"><img alt="Download_button" class="button" src="heatmap_algorythm_elemei/download_button.png" border="0"></a>

            <a href="https://github.com/signup" data-method="post"><img alt="fork" class="button" src="heatmap_algorythm_elemei/fork_button.png"></a>
        </div>

          <div class="security public_security" style="">
            <a href="#public_repo" rel="facebox"><img alt="public" src="heatmap_algorythm_elemei/public.png"></a>
          </div>

        <div id="private_repo" class="hidden">
          <h2>Private Gist</h2>
          <p>
            All pages are served over SSL and all pushing and pulling is done over SSH.
            No one may fork, clone, or view it unless they are given this private URL.
          </p>
          <p>Every gist with this icon (<img alt="private" src="heatmap_algorythm_elemei/private.png">) is private.</p>
        </div>
        <div class="security public_security" style="display:none">
          <a href="#public_repo" rel="facebox"><img alt="public" src="heatmap_algorythm_elemei/public.png"></a>
        </div>
        <div id="public_repo" class="hidden">
          <h2>Public Gist</h2>
          <p>Anyone may fork, clone, or view it.</p>
          <p>Every repository with this icon (<img alt="public" src="heatmap_algorythm_elemei/public.png">) is public.</p>
        </div>
      </div>

      <div class="meta">
        <table>

            <tbody><tr>
              <td class="label">Public Clone URL:</td>
              <td>
                <a rel="#git-clone" class="git_url_facebox" href="git://gist.github.com/346165.git">git://gist.github.com/346165.git</a>
                <div id="git-clone" style="display:none; min-width:500px">
                  Give this clone URL to anyone.
                  <br>

                  <code>git clone git://gist.github.com/346165.git gist-346165</code>
                </div>
              </td>
            </tr>


            <tr>
              <td class="label">Embed All Files:</td>
              <td>
                <a href="#" class="gist-embed-link">show embed</a>
                <input class="gist-embed-box" size="25" value="&lt;script src=&quot;https://gist.github.com/346165.js&quot;&gt; &lt;/script&gt;" style="display: none;" type="text">
              </td>
            </tr>

        </tbody></table>
      </div>
    </div>
  </div>

  <div id="files" class="instapaper_body">

        <div class="file" id="file_heatmap_trial.html">
  <div class="meta clearfix instapaper_ignore readability-extra">
    <div class="info">
      <span class="code">
          heatmap_trial.html
        <a href="#file_heatmap_trial.html">#</a>
      </span>
    </div>
    <div class="actions">
      <div id="gist-embed" style="display:inline;">
        <a href="#" class="gist-embed-link">embed</a>
        <input class="gist-embed-box" size="25" value="&lt;script src=&quot;https://gist.github.com/346165.js?file=heatmap_trial.html&quot;&gt;&lt;/script&gt;" style="display: none;" type="text">
      </div>
      <a href="https://gist.github.com/raw/346165/6cdff3255f584ec12ddc915a2d4970de5d8ffc5b/heatmap_trial.html">raw</a>
    </div>
  </div>
    <div class="data type-html">
      <table class="lines" cellpadding="0" cellspacing="0">
        <tbody><tr>
          <td>
            <pre class="line_numbers"><span id="L1" rel="#L1">1</span>
<span id="L2" rel="#L2">2</span>
<span id="L3" rel="#L3">3</span>
<span id="L4" rel="#L4">4</span>
<span id="L5" rel="#L5">5</span>
<span id="L6" rel="#L6">6</span>
<span id="L7" rel="#L7">7</span>
<span id="L8" rel="#L8">8</span>
<span id="L9" rel="#L9">9</span>
<span id="L10" rel="#L10">10</span>
<span id="L11" rel="#L11">11</span>
<span id="L12" rel="#L12">12</span>
<span id="L13" rel="#L13">13</span>
<span id="L14" rel="#L14">14</span>
<span id="L15" rel="#L15">15</span>
<span id="L16" rel="#L16">16</span>
<span id="L17" rel="#L17">17</span>
<span id="L18" rel="#L18">18</span>
<span id="L19" rel="#L19">19</span>
<span id="L20" rel="#L20">20</span>
<span id="L21" rel="#L21">21</span>
<span id="L22" rel="#L22">22</span>
<span id="L23" rel="#L23">23</span>
<span id="L24" rel="#L24">24</span>
<span id="L25" rel="#L25">25</span>
<span id="L26" rel="#L26">26</span>
<span id="L27" rel="#L27">27</span>
<span id="L28" rel="#L28">28</span>
<span id="L29" rel="#L29">29</span>
<span id="L30" rel="#L30">30</span>
<span id="L31" rel="#L31">31</span>
<span id="L32" rel="#L32">32</span>
<span id="L33" rel="#L33">33</span>
<span id="L34" rel="#L34">34</span>
<span id="L35" rel="#L35">35</span>
<span id="L36" rel="#L36">36</span>
<span id="L37" rel="#L37">37</span>
<span id="L38" rel="#L38">38</span>
<span id="L39" rel="#L39">39</span>
<span id="L40" rel="#L40">40</span>
<span id="L41" rel="#L41">41</span>
<span id="L42" rel="#L42">42</span>
<span id="L43" rel="#L43">43</span>
<span id="L44" rel="#L44">44</span>
<span id="L45" rel="#L45">45</span>
<span id="L46" rel="#L46">46</span>
<span id="L47" rel="#L47">47</span>
<span id="L48" rel="#L48">48</span>
<span id="L49" rel="#L49">49</span>
<span id="L50" rel="#L50">50</span>
<span id="L51" rel="#L51">51</span>
<span id="L52" rel="#L52">52</span>
<span id="L53" rel="#L53">53</span>
<span id="L54" rel="#L54">54</span>
<span id="L55" rel="#L55">55</span>
<span id="L56" rel="#L56">56</span>
<span id="L57" rel="#L57">57</span>
<span id="L58" rel="#L58">58</span>
<span id="L59" rel="#L59">59</span>
<span id="L60" rel="#L60">60</span>
<span id="L61" rel="#L61">61</span>
<span id="L62" rel="#L62">62</span>
<span id="L63" rel="#L63">63</span>
<span id="L64" rel="#L64">64</span>
<span id="L65" rel="#L65">65</span>
<span id="L66" rel="#L66">66</span>
<span id="L67" rel="#L67">67</span>
<span id="L68" rel="#L68">68</span>
<span id="L69" rel="#L69">69</span>
<span id="L70" rel="#L70">70</span>
<span id="L71" rel="#L71">71</span>
<span id="L72" rel="#L72">72</span>
<span id="L73" rel="#L73">73</span>
<span id="L74" rel="#L74">74</span>
<span id="L75" rel="#L75">75</span>
<span id="L76" rel="#L76">76</span>
<span id="L77" rel="#L77">77</span>
<span id="L78" rel="#L78">78</span>
<span id="L79" rel="#L79">79</span>
<span id="L80" rel="#L80">80</span>
<span id="L81" rel="#L81">81</span>
<span id="L82" rel="#L82">82</span>
<span id="L83" rel="#L83">83</span>
<span id="L84" rel="#L84">84</span>
<span id="L85" rel="#L85">85</span>
<span id="L86" rel="#L86">86</span>
<span id="L87" rel="#L87">87</span>
<span id="L88" rel="#L88">88</span>
<span id="L89" rel="#L89">89</span>
<span id="L90" rel="#L90">90</span>
<span id="L91" rel="#L91">91</span>
<span id="L92" rel="#L92">92</span>
<span id="L93" rel="#L93">93</span>
<span id="L94" rel="#L94">94</span>
<span id="L95" rel="#L95">95</span>
<span id="L96" rel="#L96">96</span>
<span id="L97" rel="#L97">97</span>
<span id="L98" rel="#L98">98</span>
<span id="L99" rel="#L99">99</span>
<span id="L100" rel="#L100">100</span>
<span id="L101" rel="#L101">101</span>
<span id="L102" rel="#L102">102</span>
<span id="L103" rel="#L103">103</span>
<span id="L104" rel="#L104">104</span>
<span id="L105" rel="#L105">105</span>
<span id="L106" rel="#L106">106</span>
<span id="L107" rel="#L107">107</span>
<span id="L108" rel="#L108">108</span>
<span id="L109" rel="#L109">109</span>
<span id="L110" rel="#L110">110</span>
<span id="L111" rel="#L111">111</span>
<span id="L112" rel="#L112">112</span>
<span id="L113" rel="#L113">113</span>
<span id="L114" rel="#L114">114</span>
<span id="L115" rel="#L115">115</span>
<span id="L116" rel="#L116">116</span>
<span id="L117" rel="#L117">117</span>
<span id="L118" rel="#L118">118</span>
<span id="L119" rel="#L119">119</span>
<span id="L120" rel="#L120">120</span>
<span id="L121" rel="#L121">121</span>
<span id="L122" rel="#L122">122</span>
<span id="L123" rel="#L123">123</span>
<span id="L124" rel="#L124">124</span>
<span id="L125" rel="#L125">125</span>
<span id="L126" rel="#L126">126</span>
<span id="L127" rel="#L127">127</span>
<span id="L128" rel="#L128">128</span>
<span id="L129" rel="#L129">129</span>
<span id="L130" rel="#L130">130</span>
<span id="L131" rel="#L131">131</span>
<span id="L132" rel="#L132">132</span>
<span id="L133" rel="#L133">133</span>
</pre>
          </td>
          <td width="100%">
                <div class="highlight"><pre><div class="line" id="LC1"><span class="cp">&lt;!DOCTYPE html&gt;</span></div><div class="line" id="LC2"><span class="nt">&lt;html&gt;</span></div><div class="line" id="LC3"><span class="nt">&lt;body&gt;</span></div><div class="line" id="LC4">&nbsp;&nbsp;<span class="nt">&lt;canvas</span> <span class="na">id=</span><span class="s">"c"</span> <span class="na">style=</span><span class="s">"width:500px; height:500px; background-color: grey"</span><span class="nt">&gt;</span></div><div class="line" id="LC5">&nbsp;&nbsp;&nbsp;&nbsp;</div><div class="line" id="LC6">&nbsp;&nbsp;</div><div class="line" id="LC7">&nbsp;&nbsp;<span class="nt">&lt;/canvas&gt;</span></div><div class="line" id="LC8">&nbsp;&nbsp;</div><div class="line" id="LC9">&nbsp;&nbsp;</div><div class="line" id="LC10">&nbsp;&nbsp;<span class="nt">&lt;script&gt;</span></div><div class="line" id="LC11">&nbsp;&nbsp;<span class="kd">var</span> <span class="nx">canvas</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">"c"</span><span class="p">);</span></div><div class="line" id="LC12">&nbsp;&nbsp;<span class="kd">var</span> <span class="nx">context</span> <span class="o">=</span> <span class="nx">canvas</span><span class="p">.</span><span class="nx">getContext</span><span class="p">(</span><span class="s2">"2d"</span><span class="p">);</span></div><div class="line" id="LC13"><br></div><div class="line" id="LC14">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kd">var</span> <span class="nx">width</span> <span class="o">=</span> <span class="mi">500</span><span class="p">;</span><span class="c1">//canvas.width;</span></div><div class="line" id="LC15">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kd">var</span> <span class="nx">height</span> <span class="o">=</span> <span class="mi">500</span><span class="p">;</span><span class="c1">//canvas.height;</span></div><div class="line" id="LC16"><br></div><div class="line" id="LC17">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kd">var</span> <span class="nx">grid</span> <span class="o">=</span> <span class="p">[];</span></div><div class="line" id="LC18">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kd">function</span> <span class="nx">init_grid</span><span class="p">()</span> <span class="p">{</span></div><div class="line" id="LC19">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">width</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span></div><div class="line" id="LC20">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nx">grid</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">[];</span></div><div class="line" id="LC21">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">height</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span></div><div class="line" id="LC22">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nx">grid</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">j</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span></div><div class="line" id="LC23">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line" id="LC24">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line" id="LC25">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line" id="LC26">&nbsp;&nbsp;&nbsp;&nbsp;</div><div class="line" id="LC27">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kd">function</span> <span class="nx">assert_point_in_grid</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">)</span> <span class="p">{</span></div><div class="line" id="LC28">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span><span class="p">(</span><span class="nx">x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">||</span> <span class="nx">x</span> <span class="o">&gt;</span> <span class="nx">width</span> <span class="o">||</span> <span class="nx">y</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">||</span> <span class="nx">y</span> <span class="o">&gt;</span> <span class="nx">height</span><span class="p">)</span></div><div class="line" id="LC29">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">throw</span> <span class="s2">"Point ("</span> <span class="o">+</span> <span class="nx">x</span> <span class="o">+</span> <span class="s2">", "</span> <span class="o">+</span> <span class="nx">y</span> <span class="o">+</span> <span class="s2">") not in grid ["</span> <span class="o">+</span> <span class="nx">width</span> <span class="o">+</span> <span class="s2">" , "</span> <span class="o">+</span> <span class="nx">height</span> <span class="o">+</span> <span class="s2">"]"</span><span class="p">;</span></div><div class="line" id="LC30">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line" id="LC31"><br></div><div class="line" id="LC32">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kd">var</span> <span class="nx">radius</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span></div><div class="line" id="LC33">&nbsp;&nbsp;&nbsp;&nbsp;</div><div class="line" id="LC34">&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">// from http://homepages.inf.ed.ac.uk/rbf/HIPR2/gsmooth.htm</span></div><div class="line" id="LC35">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kd">function</span> <span class="nx">_gaussian</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">)</span> <span class="p">{</span></div><div class="line" id="LC36">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nx">stdev</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span></div><div class="line" id="LC37">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">return</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">sqrt</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span> <span class="o">*</span> <span class="nx">stdev</span><span class="p">)</span> <span class="o">*</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">exp</span><span class="p">(</span><span class="o">-</span> <span class="p">(</span><span class="nx">x</span><span class="o">*</span><span class="nx">x</span> <span class="o">+</span> <span class="nx">y</span><span class="o">*</span><span class="nx">y</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="nx">stdev</span><span class="o">*</span><span class="nx">stdev</span><span class="p">));</span></div><div class="line" id="LC38">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line" id="LC39">&nbsp;&nbsp;</div><div class="line" id="LC40">&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">// from http://homepages.inf.ed.ac.uk/rbf/HIPR2/gsmooth.htm</span></div><div class="line" id="LC41">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kd">function</span> <span class="nx">gaussian_grid</span><span class="p">(</span><span class="nx">radius</span><span class="p">)</span> <span class="p">{</span></div><div class="line" id="LC42">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kd">var</span> <span class="nx">_gaussian_grid</span> <span class="o">=</span> <span class="p">[];</span></div><div class="line" id="LC43">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="o">-</span><span class="nx">radius</span><span class="p">;</span> <span class="nx">x</span> <span class="o">&lt;=</span> <span class="nx">radius</span><span class="p">;</span> <span class="nx">x</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span></div><div class="line" id="LC44">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nx">_gaussian_grid</span><span class="p">[</span><span class="nx">x</span> <span class="o">+</span> <span class="nx">radius</span><span class="p">]</span> <span class="o">=</span> <span class="p">[];</span></div><div class="line" id="LC45">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">y</span> <span class="o">=</span> <span class="o">-</span><span class="nx">radius</span><span class="p">;</span> <span class="nx">y</span> <span class="o">&lt;=</span> <span class="nx">radius</span><span class="p">;</span> <span class="nx">y</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span></div><div class="line" id="LC46">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nx">_gaussian_grid</span><span class="p">[</span><span class="nx">x</span> <span class="o">+</span> <span class="nx">radius</span><span class="p">][</span><span class="nx">y</span> <span class="o">+</span> <span class="nx">radius</span><span class="p">]</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">round</span><span class="p">(</span><span class="mi">127</span> <span class="o">*</span> <span class="nx">_gaussian</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">));</span></div><div class="line" id="LC47">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line" id="LC48">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span>      </div><div class="line" id="LC49">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">return</span> <span class="nx">_gaussian_grid</span><span class="p">;</span></div><div class="line" id="LC50">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line" id="LC51"><br></div><div class="line" id="LC52">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kd">var</span> <span class="nx">radius</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>    </div><div class="line" id="LC53">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kd">var</span> <span class="nx">_gaussian_grid</span> <span class="o">=</span> <span class="nx">gaussian_grid</span><span class="p">(</span><span class="nx">radius</span><span class="p">);</span></div><div class="line" id="LC54">&nbsp;&nbsp;&nbsp;&nbsp;</div><div class="line" id="LC55"><br></div><div class="line" id="LC56">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kd">function</span> <span class="nx">gaussian</span><span class="p">(</span><span class="nx">xi</span><span class="p">,</span> <span class="nx">yi</span><span class="p">)</span> <span class="p">{</span></div><div class="line" id="LC57">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">return</span> <span class="nx">_gaussian_grid</span><span class="p">[</span><span class="nx">xi</span> <span class="o">+</span> <span class="nx">radius</span><span class="p">][</span><span class="nx">yi</span> <span class="o">+</span> <span class="nx">radius</span><span class="p">];</span></div><div class="line" id="LC58">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line" id="LC59"><br></div><div class="line" id="LC60">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kd">var</span> <span class="nx">maximum</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span></div><div class="line" id="LC61">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kd">function</span> <span class="nx">apply_gaussian</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">)</span> <span class="p">{</span></div><div class="line" id="LC62">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">xi</span> <span class="o">=</span> <span class="o">-</span><span class="nx">radius</span><span class="p">;</span> <span class="nx">xi</span> <span class="o">&lt;=</span> <span class="nx">radius</span><span class="p">;</span> <span class="nx">xi</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span></div><div class="line" id="LC63">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">yi</span> <span class="o">=</span> <span class="o">-</span><span class="nx">radius</span><span class="p">;</span> <span class="nx">yi</span> <span class="o">&lt;=</span> <span class="nx">radius</span><span class="p">;</span> <span class="nx">yi</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span></div><div class="line" id="LC64">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kd">var</span> <span class="nx">cell_value</span> <span class="o">=</span> <span class="nx">grid</span><span class="p">[</span><span class="nx">x</span> <span class="o">+</span> <span class="nx">xi</span><span class="p">][</span><span class="nx">y</span> <span class="o">+</span> <span class="nx">yi</span><span class="p">]</span> <span class="o">+=</span> <span class="nx">gaussian</span><span class="p">(</span><span class="nx">xi</span><span class="p">,</span> <span class="nx">yi</span><span class="p">);</span></div><div class="line" id="LC65">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nx">maximum</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nx">cell_value</span><span class="p">,</span> <span class="nx">maximum</span><span class="p">);</span></div><div class="line" id="LC66">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line" id="LC67">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line" id="LC68">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line" id="LC69"><br></div><div class="line" id="LC70">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kd">function</span> <span class="nx">add_point</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">)</span> <span class="p">{</span></div><div class="line" id="LC71">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nx">assert_point_in_grid</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">);</span></div><div class="line" id="LC72">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nx">apply_gaussian</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">)</span></div><div class="line" id="LC73">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line" id="LC74">&nbsp;&nbsp;&nbsp;&nbsp;</div><div class="line" id="LC75">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kd">function</span> <span class="nx">each_row</span><span class="p">(</span><span class="nx">action</span><span class="p">)</span> <span class="p">{</span></div><div class="line" id="LC76">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">y</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="nx">y</span> <span class="o">&lt;=</span> <span class="nx">height</span><span class="p">;</span> <span class="nx">y</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span></div><div class="line" id="LC77">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nx">action</span><span class="p">(</span><span class="nx">y</span><span class="p">);</span></div><div class="line" id="LC78">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line" id="LC79">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line" id="LC80">&nbsp;&nbsp;&nbsp;&nbsp;</div><div class="line" id="LC81">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kd">function</span> <span class="nx">each_cell</span><span class="p">(</span><span class="nx">action</span><span class="p">)</span> <span class="p">{</span></div><div class="line" id="LC82">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nx">each_row</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">y</span><span class="p">)</span> <span class="p">{</span></div><div class="line" id="LC83">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="nx">x</span> <span class="o">&lt;=</span> <span class="nx">width</span><span class="p">;</span> <span class="nx">x</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span></div><div class="line" id="LC84">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nx">action</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">);</span></div><div class="line" id="LC85">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line" id="LC86">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">});</span></div><div class="line" id="LC87">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line" id="LC88">&nbsp;&nbsp;&nbsp;&nbsp;</div><div class="line" id="LC89">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kd">function</span> <span class="nx">print_grid</span><span class="p">()</span> <span class="p">{</span></div><div class="line" id="LC90">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nx">each_row</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">y</span><span class="p">)</span> <span class="p">{</span></div><div class="line" id="LC91">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">grid</span><span class="p">[</span><span class="nx">y</span><span class="p">].</span><span class="nx">join</span><span class="p">(</span><span class="s2">"\t"</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"\n"</span><span class="p">);</span></div><div class="line" id="LC92">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">});</span></div><div class="line" id="LC93">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line" id="LC94">&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">// Render grid translates our grid to the canvas. It ignores all points that have no value (=0)</span></div><div class="line" id="LC95">&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">// and gives a color to those who have, but this is depending on the maximum value</span></div><div class="line" id="LC96">&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">// TODO fix the color generation, it does not give a very smooth image</span></div><div class="line" id="LC97">&nbsp;&nbsp;&nbsp;&nbsp;<span class="kd">function</span> <span class="nx">render_grid</span><span class="p">()</span> <span class="p">{</span></div><div class="line" id="LC98">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nx">each_cell</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">){</span></div><div class="line" id="LC99">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kd">var</span> <span class="nx">value</span> <span class="o">=</span> <span class="nx">grid</span><span class="p">[</span><span class="nx">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="nx">y</span> <span class="o">-</span> <span class="mi">1</span><span class="p">];</span></div><div class="line" id="LC100">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">// console.log(value);</span></div><div class="line" id="LC101">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="k">if</span><span class="p">(</span><span class="nx">value</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span></div><div class="line" id="LC102">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nx">color</span> <span class="o">=</span> <span class="p">(</span><span class="nx">value</span> <span class="o">/</span> <span class="nx">maximum</span><span class="p">)</span> <span class="o">*</span> <span class="mi">255</span><span class="p">;</span></div><div class="line" id="LC103">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nx">context</span><span class="p">.</span><span class="nx">fillStyle</span> <span class="o">=</span> <span class="s2">"rgba(200,"</span> <span class="o">+</span> <span class="nx">color</span> <span class="o">+</span> <span class="s2">", 0, 0.5)"</span><span class="p">;</span></div><div class="line" id="LC104">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"value : "</span> <span class="o">+</span> <span class="nx">value</span> <span class="o">+</span> <span class="s2">", "</span> <span class="o">+</span> <span class="s2">", color "</span> <span class="o">+</span> <span class="nx">color</span><span class="p">);</span></div><div class="line" id="LC105">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="nx">context</span><span class="p">.</span><span class="nx">fillRect</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span></div><div class="line" id="LC106">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line" id="LC107">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">});</span></div><div class="line" id="LC108">&nbsp;&nbsp;&nbsp;&nbsp;<span class="p">}</span></div><div class="line" id="LC109">&nbsp;&nbsp;&nbsp;&nbsp;</div><div class="line" id="LC110">&nbsp;&nbsp;&nbsp;&nbsp;</div><div class="line" id="LC111">&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">//TODO try to get a map such as heatmapapi (render grid above)</span></div><div class="line" id="LC112">&nbsp;&nbsp;&nbsp;&nbsp;</div><div class="line" id="LC113">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nx">init_grid</span><span class="p">();</span></div><div class="line" id="LC114">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nx">add_point</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span></div><div class="line" id="LC115">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nx">add_point</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">);</span></div><div class="line" id="LC116">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nx">add_point</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">);</span></div><div class="line" id="LC117">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nx">add_point</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">);</span></div><div class="line" id="LC118">&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">// add_point(53, 53);</span></div><div class="line" id="LC119">&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">// add_point(53, 54);</span></div><div class="line" id="LC120">&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">// add_point(53, 54);</span></div><div class="line" id="LC121">&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">// add_point(20, 20);</span></div><div class="line" id="LC122">&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">// add_point(40, 60);</span></div><div class="line" id="LC123">&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">// add_point(100, 100);</span></div><div class="line" id="LC124">&nbsp;&nbsp;&nbsp;&nbsp;<span class="c1">// print_grid();</span></div><div class="line" id="LC125">&nbsp;&nbsp;&nbsp;&nbsp;<span class="nx">render_grid</span><span class="p">();</span></div><div class="line" id="LC126">&nbsp;&nbsp;<span class="nt">&lt;/script&gt;</span></div><div class="line" id="LC127">&nbsp;&nbsp;</div><div class="line" id="LC128"><span class="nt">&lt;/body&gt;</span></div><div class="line" id="LC129"><br></div><div class="line" id="LC130"><span class="nt">&lt;/html&gt;</span></div><div class="line" id="LC131"><br></div><div class="line" id="LC132"><br></div><div class="line" id="LC133"><br></div></pre></div>
          </td>
        </tr>
      </tbody></table>
  </div>

</div>


     <!-- cache end -->


  </div>

    <div id="comments">

        Please <a href="https://gist.github.com/login?return_to=%2F346165">log in</a> to comment.
    </div>

</div><!-- /.main -->

    </div> <!-- site -->

    <div class="push"></div>

    </div>

    <div id="footer">
      <div class="site">
        <div class="info">
          <div class="logo">
            <a href="https://github.com/">
              <img alt="GitHub" src="heatmap_algorythm_elemei/logo_white.png">
            </a>
          </div>
          <div class="more">
            <div class="links">
              <a href="https://github.com/blog"><strong>Blog</strong></a> |
              <a href="https://github.com/about">About</a> |
              <a href="https://github.com/contact">Support</a> |
              <a href="https://github.com/contact">Contact</a> |
              <a href="https://github.com/site/privacy">Privacy</a> |
              <a href="https://github.com/site/terms">Terms of Service</a>
            </div>
            <div class="company">
              ©
              2011
              <span id="_rrt" title="0.05612s from fe9.rs.github.com">GitHub</span> Inc.
              All rights reserved.
           </div>
          </div>
        </div>
        <div class="sponsor">
          <div>
            Powered by the <a href="http://www.rackspace.com/">Dedicated
            Servers</a> and<br> <a href="http://www.rackspacecloud.com/">Cloud
            Computing</a> of Rackspace Hosting<span>®</span>
          </div>
          <a href="http://www.rackspace.com/">
            <img alt="Dedicated Server" src="heatmap_algorythm_elemei/rackspace_logo.png">
          </a>
        </div>
      </div>
    </div>
  

    <div id="facebox" style="display:none;">       <div class="popup">         <div class="content">         </div>         <a href="#" class="close"><img src="heatmap_algorythm_elemei/closelabel.png" class="close_image" title="close"></a>       </div>     </div></body></html>